#ifndef GAUSS_LEGENDRE_HPP
#define GAUSS_LEGENDRE_HPP

namespace Plato 
{

template <typename ScalarT>
struct GaussLegendre
{
    static constexpr Plato::OrdinalType MaxNumPoints = 11;
    static constexpr Plato::OrdinalType MaxNumRules  = 4;
    static constexpr Plato::OrdinalType MaxNumDegree = 5;
    static constexpr Plato::OrdinalType MaxDimension = 3;
 
    struct Rule
    {
        Plato::OrdinalType npoints;
        ScalarT points[MaxNumPoints][MaxDimension];
        ScalarT weights[MaxNumPoints];
    };

  private:    
    /*! 
        Gauss Legendre Rules indexed by dimension 
     */
    static constexpr Rule GaussLegendreRules[MaxDimension][MaxNumRules] = 
    {
      /* 1d */
      { 
        /* 1 point rule, degree 1 */
        { 1,
          { 
            {1./2., 0., 0.} 
          },               
          { 1.    } 
        },

        /* 2 point rule, degree 3 */
        { 2,
          { 
            {0.2113248654051871177454256097490212721763, 0., 0.},
            {0.7886751345948128822545743902509787278237, 0., 0.} 
          }, 
          { 1./2., 1./2. }
        },

        /* 3 point rule, degree 5 */
        { 3,
          { 
            {0.11270166537925831864853226827052373076285, 0., 0.},
            {0.0, 0., 0.},
            {0.88729833462074168135146773172947626923715, 0., 0.}
          }, 
          {0.27777777777777777777777777777777777777777,
           0.44444444444444444444444444444444444444444,
           0.27777777777777777777777777777777777777777}
        },

        /* 4 point rule, degree 7 */
        { 4,
          { 
            {0.93056815579702627397998900615436226581239, 0., 0.},
            {0.66999052179242813194174823890878807698000, 0., 0.},
            {0.33000947820757186805825176109121192302037, 0., 0.},
            {0.069431844202973726020010993845637734187607, 0., 0.}
          }, 
          {0.17392742256872692868653197461099970361762,
           0.32607257743127307131346802538900029638238,
           0.32607257743127307131346802538900029638238,
           0.17392742256872692868653197461099970361762}
        }
      },

      /* 2d */
      {
        /* 1 point rule, degree 1 */
        { 1,
          { 
            {1./3., 1./3., 0.}
          },
          { 1./2. }
        },

        /* 3 point rule, degree 2 */
        { 3,
          {
            {1./6., 1./6., 0.}, 
            {1./6., 2./3., 0.}, 
            {2./3., 1./6., 0.} 
          }, 
          { 1./6., 1./6., 1./6. }
        },

        /* 4 point rule, degree 3 */
        { 4,
          {
            {1./3., 1./3., 0.}, 
            {1./5., 1./5., 0.}, 
            {1./5., 3./5., 0.},
            {3./5., 1./5., 0.} 
          }, 
          {-9./32., 25./96., 25./96., 25./96. }
        },

        /* 6 point rule, degree 4 */
        { 6,
          {
            {0.091576213509771, 0.091576213509771, 0.},
            {0.816847572980459, 0.091576213509771, 0.},
            {0.091576213509771, 0.816847572980459, 0.},
            {0.445948490915965, 0.445948490915965, 0.},
            {0.108103018168070, 0.445948490915965, 0.},
            {0.445948490915965, 0.108103018168070, 0.}
          }, 
          { 0.109951743655322, 0.109951743655322, 0.109951743655322, 
            0.223381589678011, 0.223381589678011, 0.223381589678011 }
        }
      },

      /* 3d */
      {
        /* 1 point rule, degree 1 */
        { 1,
          {
            {1./4., 1./4., 1./4.}
          },
          { 1./6. }
        },

        /* 4 point rule, degree 2 */
        { 4,
          {
            {0.1381966011250105151795413165634361882280,
             0.1381966011250105151795413165634361882280,
             0.1381966011250105151795413165634361882280},
            {0.5854101966249684544613760503096914353161,
             0.1381966011250105151795413165634361882280,
             0.1381966011250105151795413165634361882280},
            {0.1381966011250105151795413165634361882280,
             0.5854101966249684544613760503096914353161,
             0.1381966011250105151795413165634361882280},
            {0.1381966011250105151795413165634361882280,
             0.1381966011250105151795413165634361882280,
             0.5854101966249684544613760503096914353161} 
          }, 
          { 1./24., 1./24., 1./24., 1./24. } 
        },

        /* 5 point rule, degree 3 */
        { 5,
          {
            {2.50000000000000e-01,  2.50000000000000e-01,  2.50000000000000e-01},
            {1.66666666666667e-01,  1.66666666666667e-01,  1.66666666666667e-01},
            {1.66666666666667e-01,  1.66666666666667e-01,  5.00000000000000e-01},
            {1.66666666666667e-01,  5.00000000000000e-01,  1.66666666666667e-01},
            {5.00000000000000e-01,  1.66666666666667e-01,  1.66666666666667e-01},
          }, 
          { 
            -1.66666666666666e-01, 7.50000000000000e-02, 7.50000000000000e-02, 7.50000000000000e-02, 7.50000000000000e-02
          }
        },

        /* 11 point rule, degree 4 */
        { 11,
          {
            {2.50000000000000e-01,  2.50000000000000e-01,  2.50000000000000e-01},
            {7.14285714285715e-02,  7.14285714285715e-02,  7.14285714285715e-02},
            {7.14285714285715e-02,  7.14285714285715e-02,  7.85714285714285e-01},
            {7.14285714285715e-02,  7.85714285714285e-01,  7.14285714285715e-02},
            {7.85714285714285e-01,  7.14285714285715e-02,  7.14285714285715e-02},
            {3.99403576166799e-01,  3.99403576166799e-01,  1.00596423833201e-01},
            {3.99403576166799e-01,  1.00596423833201e-01,  3.99403576166799e-01},
            {1.00596423833201e-01,  3.99403576166799e-01,  3.99403576166799e-01},
            {3.99403576166799e-01,  1.00596423833201e-01,  1.00596423833201e-01},
            {1.00596423833201e-01,  3.99403576166799e-01,  1.00596423833201e-01},
            {1.00596423833201e-01,  1.00596423833201e-01,  3.99403576166799e-01}
          }, 
          { 
            -1.31555555555555e-02, 7.62222222222225e-03, 7.62222222222225e-03, 7.62222222222225e-03, 
             7.62222222222225e-03, 2.48888888888889e-02, 2.48888888888889e-02, 2.48888888888889e-02, 
             2.48888888888889e-02, 2.48888888888889e-02, 2.48888888888889e-02
          }
        }
      }
    };

  public:
    static const Rule Rules[MaxDimension][MaxNumDegree];
};

template <typename ScalarT>
const typename GaussLegendre<ScalarT>::Rule 
GaussLegendre<ScalarT>::Rules[MaxDimension][MaxNumDegree] = 
    { 
      {
        GaussLegendreRules[0][0], /* degree 0 */
        GaussLegendreRules[0][0], /* degree 1 */
        GaussLegendreRules[0][1], /* degree 2 */
        GaussLegendreRules[0][1], /* degree 3 */
        GaussLegendreRules[0][2]  /* degree 4 */
      },
      {
        GaussLegendreRules[1][0], /* degree 0 */
        GaussLegendreRules[1][0], /* degree 1 */
        GaussLegendreRules[1][1], /* degree 2 */
        GaussLegendreRules[1][2], /* degree 3 */
        GaussLegendreRules[1][3]  /* degree 4 */
      },
      {
        GaussLegendreRules[2][0], /* degree 0 */
        GaussLegendreRules[2][0], /* degree 1 */
        GaussLegendreRules[2][1], /* degree 2 */
        GaussLegendreRules[2][2], /* degree 3 */
        GaussLegendreRules[2][3]  /* degree 4 */
      }
    };

}
#endif
